{% extends 'shop/base.html' %}
{% load static %}

{% block content %}
<h1>Welcome to S&P Traders</h1>

<div class="categories">
    <h2>Categories</h2>
    <ul>
        {% for category in categories %}
            <li>{{ category.name }}</li>
        {% empty %}
            <li>No categories available.</li>
        {% endfor %}
    </ul>
</div>

<div class="products">
    <h2>Products</h2>
    <div class="product-grid">
        {% for product in products %}
            <div class="product-card">
                <h3>{{ product.name }}</h3>
                <p>Category: {{ product.category.name }}</p>
                <p>Price: KES {{ product.price }}</p>

                {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" width="150">
                {% endif %}

                <p>{{ product.description|truncatechars:100 }}</p>

                <!-- Add to Cart -->
                {% if user.is_authenticated %}
                    <form action="{% url 'add_to_cart' product.id %}" method="POST">
                        {% csrf_token %}
                        <button type="submit">Add to Cart</button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}">Login to add to cart</a>
                {% endif %}

                <!-- Link to Product Detail -->
                <p><a href="{% url 'product_detail' product.id %}">View Details</a></p>
            </div>
        {% empty %}
            <p>No products available.</p>
        {% endfor %}
    </div>
</div>

<style>
.product-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}
.product-card {
    border: 1px solid #ddd;
    padding: 15px;
    width: 200px;
    border-radius: 10px;
    box-shadow: 1px 1px 5px #ccc;
}
.product-card img {
    display: block;
    margin: 10px 0;
}
button {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 5px;
    cursor: pointer;
}
button:hover {
    background-color: #218838;
}
</style>
{% endblock %}
